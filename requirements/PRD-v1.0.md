# TxTracer for BSC — 产品需求文档 v1.0

**文档状态：** 草稿  
**版本：** v1.0  
**作者：** Vault (PM)  
**创建日期：** 2026-02-28  

---

## 一、产品概述

TxTracer 是一个面向 BSC（币安智能链）用户的交易查询与失败原因分析工具。用户输入交易哈希（TxHash），系统自动拉取链上数据，呈现交易详情，并对失败交易给出**中文原因说明和修复建议**。

**核心价值：** 不只告诉你"交易失败了"，还告诉你**为什么失败、怎么修复**。

---

## 二、用户故事

| # | 角色 | 我想要 | 以便于 |
|---|------|--------|--------|
| 1 | 普通用户 | 输入 TxHash 查看交易状态 | 快速了解链上交易结果 |
| 2 | 普通用户 | 看到失败原因的中文说明 | 不需要懂技术也能理解错误 |
| 3 | 开发者 | 查看原始 revert data 和错误类型 | 快速定位合约 bug |
| 4 | 普通用户 | 一键跳转 BscScan | 查看更多原始链上数据 |

---

## 三、功能需求

### 3.1 交易查询（核心功能）

**输入：**
- TxHash（66 位十六进制，0x 开头）
- 格式校验：非法输入给出明确提示

**输出（交易详情）：**

| 字段 | 说明 |
|------|------|
| 交易哈希 | TxHash 全文 + 复制按钮 |
| 状态 | SUCCESS / FAILED / PENDING / NOT FOUND |
| 区块号 | blockNumber |
| 时间 | datetime（UTC+8，格式：YYYY-MM-DD HH:mm:ss） |
| From | 发送方地址 |
| To | 接收方地址 |
| 金额 | value + 单位（BNB） |
| Gas Limit | gasLimit |
| Gas Used | gasUsed |
| Gas Price | gasPrice（Gwei） |
| 手续费 | gasFee（BNB） |
| Nonce | nonce |
| 确认数 | confirmations |
| 输入数据 | inputData（可折叠展示） |
| BscScan 链接 | explorerUrl，点击跳转 |

---

### 3.2 失败原因分析

仅当交易状态为 **FAILED** 时展示。

| 错误类型 | 触发条件 | 展示内容 |
|----------|----------|----------|
| OUT_OF_GAS | gasUsed >= gasLimit | "Gas 耗尽，建议提高 gasLimit" |
| CONTRACT_REVERT | revert data 以 0x08c379a0 开头 | 解码后的 Error(string) + 修复建议 |
| PANIC | revert data 以 0x4e487b71 开头 | Panic 错误码对应的中文说明 |
| UNKNOWN | 其他 | 原始 revert data |

**展示结构：**
- 错误类型（中文标签）
- 错误原因（中文描述）
- 修复建议（可操作的中文提示）
- 原始数据（可折叠，面向开发者）

---

### 3.3 RPC 容错

- 主节点：https://bsc-dataseed1.binance.org
- 备用节点：https://bsc-dataseed2.binance.org
- 主节点失败自动切换备用节点，对用户透明

---

## 四、非功能需求

| 指标 | 要求 |
|------|------|
| 响应时间 | 正常查询 < 3s，链上重放 < 8s |
| 可用性 | 双节点容错，单节点故障不影响使用 |
| 兼容性 | 支持主流现代浏览器（Chrome / Firefox / Safari） |
| 移动端 | 响应式布局，手机可用 |
| 安全性 | 不存储任何用户输入数据，无需登录 |

---

## 五、接口规范

### 查询交易
GET /api/v1/tx/:txHash

**成功响应：**
{ "code": 200, "message": "success", "data": { ... } }

**错误响应：**

| code | 含义 |
|------|------|
| 400 | TxHash 格式错误 |
| 404 | 交易不存在 |
| 500 | 服务器内部错误 |

---

## 六、待办 / 后续迭代方向

- [ ] 支持多链（以太坊、Polygon、Arbitrum）
- [ ] 批量查询多个 TxHash
- [ ] 历史查询记录（本地缓存）
- [ ] 合约 ABI 解析，展示可读的函数调用参数
- [ ] 支持中英文切换

---

## 七、验收标准

1. 输入有效 TxHash，3 秒内返回完整交易详情
2. 失败交易显示中文错误原因和修复建议
3. 非法 TxHash 给出明确错误提示
4. 主节点不可用时自动切换，查询不中断
5. 移动端布局正常，无横向滚动条
6. 单元测试覆盖率 >= 95%

---

_本文档由 PM Vault 起草，开发团队有疑问请直接提 issue。_
